diff -up intel-accel-1.3/e_intelx.c.iabuild intel-accel-1.3/e_intelx.c
--- intel-accel-1.3/e_intelx.c.iabuild	2011-07-12 16:40:07.000000000 +0200
+++ intel-accel-1.3/e_intelx.c	2011-07-20 14:02:22.000000000 +0200
@@ -318,7 +318,7 @@ intelx_digests (ENGINE *e, const EVP_MD 
  */
 size_t OPENSSL_ia32_rdrand(void);
 
-static int intelx_get_random_bytes (unsigned char *buf, size_t num)
+static int intelx_get_random_bytes (unsigned char *buf, int num)
 {
 	size_t rnd;
 
diff -up intel-accel-1.3/Makefile.iabuild intel-accel-1.3/Makefile
--- intel-accel-1.3/Makefile.iabuild	2011-07-11 17:01:31.000000000 +0200
+++ intel-accel-1.3/Makefile	2011-07-20 14:06:33.000000000 +0200
@@ -4,7 +4,7 @@
 	CC=$(CC) perl $< elf > $@
 
 CC=gcc
-CFLAGS=-fPIC -O -fomit-frame-pointer -Wall
+CFLAGS=-fPIC $(RPM_OPT_FLAGS) -I../include
 AS=$(CC) -c -Wa,-noexecstack
 
 OBJ=e_intelx.o e_rc4_hmac_md5.o e_aes_cbc_hmac_sha1.o
@@ -16,7 +16,7 @@ OBJ+=sha1-586.o rc4-586.o aesni-x86.o x8
 endif
 
 libintel-accel.so:	$(OBJ) Makefile
-	$(CC) -shared -o $@ $(OBJ) -Wl,-Bsymbolic,--version-script=libintelx.map
+	$(CC) -shared -fPIC $(RPM_OPT_FLAGS) -o $@ $(OBJ) -Wl,-z,relro -Wl,-Bsymbolic,--version-script=libintelx.map
 
 sha1-%.s:		sha1-%.pl
 rc4-%.s:		rc4-%.pl
