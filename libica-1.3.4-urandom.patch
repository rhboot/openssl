--- openssl-0.9.7a/libica-1.3.5/src/prand.c.urandom	2003-07-10 16:09:35.000000000 -0400
+++ openssl-0.9.7a/libica-1.3.5/src/prand.c	2003-10-24 01:59:53.000000000 -0400
@@ -421,11 +421,26 @@
    */
 
 
+   /*
+   **   Change 10/24/03 PK: Use /dev/urandom instead.
+   */
    static unsigned char get_byte(u_int32 *array5, int current_byte)
    {
-
       u_int32 val;
+      static int rfd = 0;	/* File descriptor to /dev/urandom */
+      unsigned char retval;
+
+      if (!rfd) {
+          rfd = open("/dev/urandom", O_RDONLY);
+      }
+
+      /* If we have a valid fd for /dev/urandom then use it */
+      if (rfd) {
+         read(rfd, &retval, 1);
+         return retval;
+      }
 
+      /* Otherwise use the old pseudo random number generator */
       val = *(array5 + current_byte/4);
 
       current_byte %= 4;
