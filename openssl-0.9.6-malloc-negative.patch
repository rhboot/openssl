--- openssl-0.9.6/crypto/mem.c	2000-09-11 08:42:03.000000000 -0400
+++ openssl-0.9.6/crypto/mem.c	2003-02-19 14:01:22.000000000 -0500
@@ -174,6 +174,8 @@
 	{
 	void *ret = NULL;
 
+	if (num < 0) return NULL;
+
 	allow_customize = 0;
 	if (malloc_debug_func != NULL)
 		{
@@ -206,6 +208,8 @@
 	{
 	void *ret = NULL;
 
+	if (num < 0) return NULL;
+
 	allow_customize = 0;
 	if (malloc_debug_func != NULL)
 		{
@@ -226,6 +230,8 @@
 	{
 	void *ret = NULL;
 
+	if (num < 0) return NULL;
+
 	if (realloc_debug_func != NULL)
 		realloc_debug_func(str, NULL, num, file, line, 0);
 	ret = realloc_func(str,num);
